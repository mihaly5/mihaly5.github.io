<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Black-Scholes Option Pricing Calculator</title>
    <meta name="description" content="Professional Black-Scholes calculator with Greeks (Delta, Gamma, Theta, Vega). Calculate Call and Put option prices with numerical stability protections.">
    <link rel="stylesheet" href="style.css">
    
    <script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>

    <style>
        .greeks-grid {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 15px;
            margin-top: 15px;
            text-align: left;
        }
        .greek-item {
            background-color: #1e293b;
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #334155;
        }
        .greek-label { font-size: 0.8em; color: #94a3b8; display: block; }
        .greek-value { font-size: 1.1em; color: #fff; font-weight: bold; }
        .unit-label { font-size: 0.7em; color: #64748b; font-weight: normal; margin-left: 2px; }
        
        .warning-box {
            background-color: rgba(245, 158, 11, 0.15);
            border: 1px solid #f59e0b;
            color: #f59e0b;
            padding: 10px;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 0.9em;
            display: flex;
            align-items: center;
            gap: 10px;
        }
    </style>
</head>
<body>

    <nav>
        <ul>
            <li><a href="index.html">Home</a></li>
            <li><a href="kamatos.html">Retail: Compound Interest</a></li>
            <li><a href="hitel.html">Loan Calculator</a></li>
            <li><a href="black_scholes.html" style="color:#3b82f6;">Pro: Black-Scholes</a></li>
        </ul>
    </nav>

    <div class="container">
        <h1>Black-Scholes Model</h1>
        <p style="font-size:0.9em; color:#94a3b8;">European Option Pricing & The Greeks</p>
        
        <label>Stock Price ($):</label>
        <input type="number" id="S" value="100" min="0.01" step="0.01">

        <label>Strike Price ($):</label>
        <input type="number" id="K" value="100" min="0.01" step="0.01">

        <label>Time to Maturity (Years):</label>
        <input type="number" id="T" value="1" min="0.01" step="0.01">

        <label>Volatility (σ as %):</label>
        <input type="number" id="v" value="20" min="0.01" step="0.1">

        <label>Risk-free Rate (%):</label>
        <div style="font-size: 0.85em; color: #94a3b8; margin-top: -8px; margin-bottom: 8px;">(Continuously compounded)</div>
        <input type="number" id="r" value="5" step="0.1">

        <button class="calc-btn" onclick="calculateBS()">Calculate Option Price</button>

        <div class="result" id="bs-result" style="display:none;"></div>
    </div>

    <div class="container seo-content">
        <h2>Understanding the Black-Scholes Model</h2>
        
        <h3>What is this model?</h3>
        <p>The Black-Scholes-Merton model (1973) is a mathematical model used to estimate the theoretical price of European-style options. It revolutionized modern finance by providing a way to hedge risk and value derivatives. Our calculator uses the standard analytical solution.</p>

        <h3>Assumptions & Limitations</h3>
        <ul>
            <li><strong>European Exercise:</strong> The option can only be exercised at expiration.</li>
            <li><strong>No Dividends:</strong> This standard model assumes the stock pays no dividends. <em>(For dividend-paying stocks, the Black-Scholes-Merton model with continuous dividend yield should be used.)</em></li>
            <li><strong>Constant Volatility:</strong> It assumes volatility remains constant over the option's life, which is rarely true in reality (see "Volatility Smile").</li>
            <li><strong>Short Maturities:</strong> For very short expirations (e.g., &lt; 1 week), the model's continuous time assumption may deviate from market reality.</li>
        </ul>

        <h3>The Greeks Explained</h3>
        <p>Traders use "The Greeks" to manage risk:</p>
        <ul>
            <li><strong>Δ Delta:</strong> The sensitivity of the option price to the stock price. If Delta is 0.5, a $1 rise in stock price increases the option by $0.50.</li>
            <li><strong>Γ Gamma:</strong> Measures how fast Delta changes. High Gamma means high risk/reward for short-term moves.</li>
            <li><strong>Θ Theta (Time Decay):</strong> Shows how much value the option loses <em>per day</em> as expiration approaches. This is usually a negative number for long positions.</li>
            <li><strong>ν Vega:</strong> Sensitivity to volatility. If Vega is 0.10, a 1% increase in volatility adds $0.10 to the option price.</li>
        </ul>
    </div>

    <footer>
        <p>&copy; 2025 All Rights Reserved. | <a href="index.html" style="color:#64748b; text-decoration:none;">Home</a> | <a href="black_scholes_privacy.html" style="color:#64748b; text-decoration:none;">Privacy Policy</a></p>
        <p style="font-size:0.8em;">Calculations are for educational purposes only.</p>
    </footer>

    <script>
        // Standard Normal Cumulative Distribution Function
        function cnd(x) {
            var a1 = 0.31938153, a2 = -0.356563782, a3 = 1.781477937, a4 = -1.821255978, a5 = 1.330274429;
            var p = 0.2316419;
            var L = Math.abs(x);
            var k = 1 / (1 + p * L);
            var w = 1 - 1 / Math.sqrt(2 * Math.PI) * Math.exp(-L * L / 2) * (a1 * k + a2 * k * k + a3 * Math.pow(k, 3) + a4 * Math.pow(k, 4) + a5 * Math.pow(k, 5));
            return (x < 0) ? 1 - w : w;
        }

        // Safe CND for Numerical Stability (Handles deep ITM/OTM)
        function safeCND(x) {
            if (x > 8) return 1;
            if (x < -8) return 0;
            return cnd(x);
        }

        // Standard Normal Probability Density Function
        function pdf(x) {
            return (1 / Math.sqrt(2 * Math.PI)) * Math.exp(-(x * x) / 2);
        }

        function calculateBS() {
            // 1. INPUT RETRIEVAL
            let S = parseFloat(document.getElementById('S').value);
            let K = parseFloat(document.getElementById('K').value);
            let T = parseFloat(document.getElementById('T').value);
            let v_percent = parseFloat(document.getElementById('v').value);
            let r_percent = parseFloat(document.getElementById('r').value);

            // 2. VALIDATION (Critical for Stability)
            if (S <= 0 || K <= 0) {
                alert("Stock price and Strike price must be positive numbers.");
                return;
            }
            if (T <= 0) {
                alert("Time to maturity must be greater than 0.");
                return;
            }
            if (v_percent <= 0) {
                alert("Volatility must be greater than 0.");
                return;
            }

            // 3. PREPARATION
            let v = v_percent / 100;
            let r = r_percent / 100;

            // 4. BLACK-SCHOLES FORMULA COMPONENTS
            let d1 = (Math.log(S / K) + (r + (v * v) / 2) * T) / (v * Math.sqrt(T));
            let d2 = d1 - v * Math.sqrt(T);

            let pdf_d1 = pdf(d1); // Needed for Greeks

            // 5. OPTION PRICING
            let discountFactor = Math.exp(-r * T);
            let callPrice = S * safeCND(d1) - K * discountFactor * safeCND(d2);
            let putPrice = K * discountFactor * safeCND(-d2) - S * safeCND(-d1);

            // 6. GREEKS CALCULATION
            // Delta
            let callDelta = safeCND(d1);
            let putDelta = callDelta - 1;

            // Gamma (Same for Call & Put)
            let gamma = pdf_d1 / (S * v * Math.sqrt(T));

            // Vega (Same for Call & Put, scaled for 1% change)
            let vega = (S * pdf_d1 * Math.sqrt(T)) / 100;

            // Theta (Daily decay)
            // Common term: -(S * pdf(d1) * v) / (2 * sqrt(T))
            let term1 = -(S * pdf_d1 * v) / (2 * Math.sqrt(T));
            
            let thetaCallAnnual = term1 - r * K * discountFactor * safeCND(d2);
            let thetaPutAnnual = term1 + r * K * discountFactor * safeCND(-d2);

            let thetaCallDaily = thetaCallAnnual / 365;
            let thetaPutDaily = thetaPutAnnual / 365;

            // 7. DISPLAY RESULTS
            let usdFormatter = new Intl.NumberFormat('en-US', { style: 'currency', currency: 'USD' });
            
            // Build Warning Message if T is very short (< 0.02 years, approx 1 week)
            let warningHtml = '';
            if (T < 0.02) {
                warningHtml = `
                    <div class="warning-box">
                        <span>⚠️</span>
                        <span><strong>Note:</strong> Very short maturity detected (${T} years). The standard Black-Scholes model accuracy may degrade near expiration due to discrete market movements.</span>
                    </div>
                `;
            }

            let html = warningHtml + `
                <div style="display:grid; grid-template-columns:1fr 1fr; gap:20px; text-align:center; margin-bottom:20px;">
                    <div style="background:#334155; padding:15px; border-radius:8px; border:1px solid #10b981;">
                        <span style="color:#10b981; font-weight:bold;">CALL Price</span><br>
                        <span style="font-size:1.5em; color:#fff;">${usdFormatter.format(callPrice)}</span>
                    </div>
                    <div style="background:#334155; padding:15px; border-radius:8px; border:1px solid #ef4444;">
                        <span style="color:#ef4444; font-weight:bold;">PUT Price</span><br>
                        <span style="font-size:1.5em; color:#fff;">${usdFormatter.format(putPrice)}</span>
                    </div>
                </div>
                
                <h4 style="border-bottom:1px solid #475569; padding-bottom:5px; margin-bottom:10px;">The Greeks</h4>
                
                <div class="greeks-grid">
                    <div class="greek-item">
                        <span class="greek-label">Δ Delta</span>
                        <span class="greek-value" style="color:#10b981;">${callDelta.toFixed(4)}</span> <span class="unit-label">(Call)</span><br>
                        <span class="greek-value" style="color:#ef4444;">${putDelta.toFixed(4)}</span> <span class="unit-label">(Put)</span>
                    </div>
                    <div class="greek-item">
                        <span class="greek-label">Γ Gamma</span>
                        <span class="greek-value">${gamma.toFixed(5)}</span> <span class="unit-label">1/$</span>
                    </div>
                    <div class="greek-item">
                        <span class="greek-label">Θ Theta (Daily decay)</span>
                        <span class="greek-value" style="color:#f59e0b;">${thetaCallDaily.toFixed(4)}</span> <span class="unit-label">$/day</span><br>
                        <span class="greek-value" style="color:#f59e0b;">${thetaPutDaily.toFixed(4)}</span> <span class="unit-label">$/day</span>
                    </div>
                    <div class="greek-item">
                        <span class="greek-label">ν Vega (per 1% vol)</span>
                        <span class="greek-value">${vega.toFixed(4)}</span> <span class="unit-label">$</span>
                    </div>
                </div>
            `;

            document.getElementById('bs-result').style.display = 'block';
            document.getElementById('bs-result').innerHTML = html;
        }
    </script>
</body>
</html>